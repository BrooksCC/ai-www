(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{229:(e,t,r)=>{"use strict";r.d(t,{AuthGuard:()=>d});var o=r(5155),a=r(2115),n=r(5695),s=r(2045),i=r(1795);let l=["/profile","/chat","/character/dialogue"],d=e=>{let{children:t}=e,r=(0,n.useRouter)(),d=(0,n.usePathname)(),c=(0,s.G)(i.Kc);return(0,a.useEffect)(()=>{l.some(e=>d===e||d.startsWith("".concat(e,"/")))&&!c&&r.replace("/?auth=required")},[c,d,r]),(0,o.jsx)(o.Fragment,{children:t})}},347:()=>{},1002:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var o=r(5155),a=r(6874),n=r.n(a),s=r(5695),i=r(4540),l=r(3500),d=r(2847);function c(){let e=(0,s.usePathname)(),t=(0,s.useRouter)(),r=(0,i.d4)(e=>e.user.isAuthenticated),{stories:a}=(0,l.R7)(),{characters:c}=(0,d.Ib)(),u=t=>"/characters"===t?"/characters"===e||"/characters/"===e||"/"===e:e.startsWith(t);if("/characters"!==e&&"/characters/"!==e&&"/"!==e)return null;let h=[{name:"发现",href:"/characters",icon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),activeIcon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 100 13.5 6.75 6.75 0 000-13.5zM2.25 10.5a8.25 8.25 0 1114.59 5.28l4.69 4.69a.75.75 0 11-1.06 1.06l-4.69-4.69A8.25 8.25 0 012.25 10.5z",clipRule:"evenodd"})})},{name:"消息",href:"#",onClick:()=>{if(!r)return void document.dispatchEvent(new CustomEvent("open-login-modal",{detail:{tab:"login"}}));if(a&&a.length>0){let e=Math.floor(Math.random()*a.length),r=a[e];t.push("/chat?storyId=".concat(r.id))}else if(c&&c.length>0){let e=Math.floor(Math.random()*c.length),r=c[e];t.push("/chat?characterId=".concat(r.id))}},icon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),activeIcon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M4.804 21.644A6.707 6.707 0 006 21.75a6.721 6.721 0 003.583-1.029c.774.182 1.584.279 2.417.279 5.322 0 9.75-3.97 9.75-9 0-5.03-4.428-9-9.75-9s-9.75 3.97-9.75 9c0 1.856.56 3.605 1.554 4.893L2.097 21.23a.75.75 0 00.707 1.414z",clipRule:"evenodd"})})},{name:"创建",href:"#",icon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),activeIcon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 9a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25V15a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V9z",clipRule:"evenodd"})})},{name:"设置",href:"/profile",icon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),activeIcon:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z",clipRule:"evenodd"})})}];return(0,o.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-[var(--bg-primary)] border-t border-[var(--border-color)] z-50 md:hidden",children:(0,o.jsx)("div",{className:"flex items-center justify-around px-4 py-2",children:h.map(e=>{let t="#"!==e.href&&u(e.href);return e.onClick?(0,o.jsxs)("button",{onClick:e.onClick,className:"flex flex-col items-center space-y-1 py-2 px-3 rounded-lg transition-colors ".concat(t?"text-[var(--primary)] bg-[var(--primary)]/10":"text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]"),children:[t?e.activeIcon:e.icon,(0,o.jsx)("span",{className:"text-xs font-medium",children:e.name})]},e.name):(0,o.jsxs)(n(),{href:e.href,className:"flex flex-col items-center space-y-1 py-2 px-3 rounded-lg transition-colors ".concat(t?"text-[var(--primary)] bg-[var(--primary)]/10":"text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]"),children:[t?e.activeIcon:e.icon,(0,o.jsx)("span",{className:"text-xs font-medium",children:e.name})]},e.name)})})})}},1183:(e,t,r)=>{"use strict";r.d(t,{BV:()=>i,E4:()=>s,In:()=>d,J1:()=>n,Kp:()=>l});var o=r(8924);let a=e=>e.invitation,n=(0,o.Mz)([a],e=>e.invitationCode),s=(0,o.Mz)([a],e=>e.commissionRecords),i=(0,o.Mz)([a],e=>e.comprehensiveData),l=(0,o.Mz)([a],e=>e.loading),d=(0,o.Mz)([a],e=>e.error);(0,o.Mz)([l],e=>e.generateCode),(0,o.Mz)([l],e=>e.getComprehensiveData),(0,o.Mz)([l],e=>e.getCommissionRecords),(0,o.Mz)([d],e=>e.generateCode),(0,o.Mz)([d],e=>e.getComprehensiveData),(0,o.Mz)([d],e=>e.getCommissionRecords)},3428:(e,t,r)=>{"use strict";r.d(t,{default:()=>a}),r(5155);var o=r(2115);let a=()=>{let[e,t]=(0,o.useState)(null);return(0,o.useEffect)(()=>{},[]),null}},3875:(e,t,r)=>{"use strict";r.d(t,{ReduxProvider:()=>A});var o=r(5155),a=r(2115),n=r(4540),s=r(52),i=r(6439);let l=(0,i.Z0)({name:"app",initialState:{isLoading:!1,error:null,model:{models:[],uiModels:[],selectedModel:null,status:"idle",error:null}},reducers:{setLoading:(e,t)=>{e.isLoading=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null}}}),{setLoading:d,setError:c,clearError:u}=l.actions,h=l.reducer;var m=r(5844);r(6525);let v=(0,s.HY)({app:h,model:m.Ay});var g=r(179);r(3178),r(8613);let p=g.Ay;r(2847),r(5055);var C=r(3525);r(3500),r(298),r(971);var f=r(8578),x=r(9751);r(7464),r(1183),r(7817),x.uJ,x.f3;var w=r(6828);let y={key:"user_state",paths:["user.currentUser","user.isAuthenticated","user.settings","user.token"],whitelist:["user/"]},M=(0,w.J)(y),j=(0,s.HY)({app:v,user:p,character:C.Ay,chat:f.Ay,invitation:x.Ay}),k=(0,w.X)(y.key),b=(0,i.U1)({reducer:j,middleware:e=>e({serializableCheck:!1}).concat([M]),preloadedState:k||void 0});var D=r(6168);let R=(e,t)=>{if(!e)return void console.error("[axios-interceptor] Axios instance is not available in SDKService.");e.interceptors.response.use(e=>e,e=>{var r;return(null==(r=e.response)?void 0:r.status)===401&&(console.warn("[axios-interceptor] Received 401 Unauthorized, dispatching logout."),t.dispatch((0,g.ri)())),Promise.reject(e)}),console.log("[axios-interceptor] Axios interceptor setup complete.")},z=!1,A=e=>{let{children:t}=e,[r,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{s(!0),z||(console.log("[StoreProvider] Setting up Axios interceptor..."),R(D.o.getAxiosInstance(),b),z=!0)},[]),(0,o.jsx)(o.Fragment,{children:r?(0,o.jsx)(n.Kq,{store:b,children:t}):(0,o.jsx)(n.Kq,{store:b,children:(0,o.jsx)("div",{style:{visibility:"hidden"},children:t})})})}},4373:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.t.bind(r,8346,23)),Promise.resolve().then(r.bind(r,229)),Promise.resolve().then(r.bind(r,8663)),Promise.resolve().then(r.bind(r,3428)),Promise.resolve().then(r.bind(r,7280)),Promise.resolve().then(r.bind(r,1002)),Promise.resolve().then(r.bind(r,3875))},5844:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>m,ZC:()=>d,xH:()=>h});var o=r(6439),a=r(9249),n=r(6168),s=r(3299);class i{async getVirtualModels(){try{return(await n.o.models.getVirtualModels()).data}catch(e){throw console.error("Failed to get virtual models:",e),e}}}let l=new(i=(0,a.Cg)([s.A.Singleton],i)),d=(0,o.zD)("model/fetchModels",async()=>(await l.getVirtualModels()).models),c=e=>e.map(e=>({id:e.id,name:e.name,description:e.description||"暂无描述",price:e.pricePerK?"".concat(JSON.stringify(e.pricePerK),"/1K tokens"):"价格待定",isDefault:e.isDefault})),u=(0,o.Z0)({name:"model",initialState:{models:[],uiModels:[],selectedModel:null,status:"idle",error:null},reducers:{setSelectedModel:(e,t)=>{e.selectedModel=t.payload}},extraReducers:e=>{e.addCase(d.pending,e=>{e.status="loading"}).addCase(d.fulfilled,(e,t)=>{if(e.status="succeeded",e.models=t.payload,e.uiModels=c(t.payload),!e.selectedModel&&e.uiModels.length>0){let t=e.uiModels.find(e=>e.isDefault);e.selectedModel=t||e.uiModels[0]}}).addCase(d.rejected,(e,t)=>{e.status="failed",e.error=t.error.message||null})}}),{setSelectedModel:h}=u.actions,m=u.reducer},7464:(e,t,r)=>{"use strict";r.d(t,{w1:()=>c,CA:()=>u,kZ:()=>h});var o=r(6439),a=r(9249),n=r(6168),s=r(3299);class i{async generateInvitationCode(e){try{return(await n.o.invitation.generateInvitationCode({generateCodeRequestDto:e})).data}catch(e){throw console.error("Failed to generate invitation code:",e),e}}async getCommissionRecords(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return(await n.o.invitation.getCommissionRecords({page:e,limit:t,...r})).data}catch(e){throw console.error("Failed to get commission records:",e),e}}async getComprehensiveInviteData(){try{return(await n.o.invitation.getComprehensiveInviteData()).data}catch(e){throw console.error("Failed to get comprehensive invite data:",e),e}}}let l=new(i=(0,a.Cg)([s.A.Singleton],i)),d="invitation",c=(0,o.zD)("".concat(d,"/generateCode"),async(e,t)=>{let{rejectWithValue:r}=t;try{return await l.generateInvitationCode(e.codeData)}catch(e){return r(e instanceof Error?e.message:"Failed to generate invitation code")}}),u=(0,o.zD)("".concat(d,"/getCommissionRecords"),async(e,t)=>{let{rejectWithValue:r}=t;try{let t="object"==typeof e&&(null==e?void 0:e.page)?e.page:1,r="object"==typeof e&&(null==e?void 0:e.limit)?e.limit:10,o={type:"object"==typeof e&&(null==e?void 0:e.type)?e.type:void 0,startDate:"object"==typeof e&&(null==e?void 0:e.startDate)?e.startDate:void 0,endDate:"object"==typeof e&&(null==e?void 0:e.endDate)?e.endDate:void 0};return await l.getCommissionRecords(t,r,o)}catch(e){return r(e instanceof Error?e.message:"Failed to get commission records")}}),h=(0,o.zD)("".concat(d,"/getComprehensiveInviteData"),async(e,t)=>{let{rejectWithValue:r}=t;try{return await l.getComprehensiveInviteData()}catch(e){return r(e instanceof Error?e.message:"Failed to get comprehensive invite data")}})},7817:(e,t,r)=>{"use strict";r.d(t,{d:()=>l});var o=r(2115),a=r(2045),n=r(1183),s=r(7464),i=r(9751);let l=()=>{let e=(0,a.j)(),t=(0,a.G)(n.J1),r=(0,a.G)(n.E4),l=(0,a.G)(n.BV),d=(0,a.G)(n.Kp),c=(0,a.G)(n.In),u=(0,o.useCallback)(t=>e((0,s.w1)(t)),[e]),h=(0,o.useCallback)(t=>{e((0,s.CA)(t))},[e]);return{invitationCode:t,commissionRecords:r,comprehensiveData:l,loading:d,error:c,generateCode:u,fetchCommissionRecords:h,fetchComprehensiveData:(0,o.useCallback)(()=>{e((0,s.kZ)())},[e]),clearError:(0,o.useCallback)(t=>{e((0,i.f3)(t))},[e])}}},8346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},9751:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,f3:()=>l,uJ:()=>i});var o=r(6439),a=r(7464);let n={invitationCode:null,commissionRecords:null,comprehensiveData:null,loading:{generateCode:!1,getCommissionRecords:!1,getComprehensiveData:!1},error:{generateCode:null,getCommissionRecords:null,getComprehensiveData:null}},s=(0,o.Z0)({name:"invitation",initialState:n,reducers:{clearInvitationState:()=>n,clearInvitationError:(e,t)=>{e.error[t.payload]=null}},extraReducers:e=>{e.addCase(a.w1.pending,e=>{e.loading.generateCode=!0,e.error.generateCode=null}).addCase(a.w1.fulfilled,(e,t)=>{e.loading.generateCode=!1,e.invitationCode=t.payload}).addCase(a.w1.rejected,(e,t)=>{e.loading.generateCode=!1,e.error.generateCode=t.payload||"Unknown error"}),e.addCase(a.CA.pending,e=>{e.loading.getCommissionRecords=!0,e.error.getCommissionRecords=null}).addCase(a.CA.fulfilled,(e,t)=>{e.loading.getCommissionRecords=!1,e.commissionRecords=t.payload}).addCase(a.CA.rejected,(e,t)=>{e.loading.getCommissionRecords=!1,e.error.getCommissionRecords=t.payload||"Unknown error"}),e.addCase(a.kZ.pending,e=>{e.loading.getComprehensiveData=!0,e.error.getComprehensiveData=null}).addCase(a.kZ.fulfilled,(e,t)=>{e.loading.getComprehensiveData=!1,e.comprehensiveData=t.payload}).addCase(a.kZ.rejected,(e,t)=>{e.loading.getComprehensiveData=!1,e.error.getComprehensiveData=t.payload||"Unknown error"})}}),{clearInvitationState:i,clearInvitationError:l}=s.actions,d=s.reducer}},e=>{var t=t=>e(e.s=t);e.O(0,[838,951,320,105,428,116,455,476,613,127,663,441,684,358],()=>t(4373)),_N_E=e.O()}]);