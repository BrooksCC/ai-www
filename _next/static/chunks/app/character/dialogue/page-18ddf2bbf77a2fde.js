(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[193],{3141:(e,r,t)=>{"use strict";t.d(r,{default:()=>g});var s=t(5155),a=t(2115),l=t(5695),c=t(5298),d=t(6821),n=t(6766),i=t(285),o=t(7374);let x=[{id:"1",sender:"character",content:"你好，我是裴清商。有什么事吗？",timestamp:"19:30"},{id:"2",sender:"user",content:"你好，我想和你聊聊天，了解一下你。",timestamp:"19:31"},{id:"3",sender:"character",content:"哦？想了解我？我是一个性格比较冷淡的人，不太习惯和陌生人交流。不过，既然你这么有兴趣，我可以稍微聊一会儿。你想知道什么？",timestamp:"19:32"},{id:"4",sender:"user",content:"你平时都喜欢做什么事情？有什么爱好吗？",timestamp:"19:33"},{id:"5",sender:"character",content:"我喜欢安静的环境，经常会读一些书，偶尔也会听音乐。不太喜欢嘈杂的场合，所以很少参加社交活动。工作之余，我会在家里整理一些东西，保持一种秩序感对我很重要。",timestamp:"19:35"},{id:"6",sender:"user",content:"听起来你是一个很独立的人。你的工作是什么？",timestamp:"19:36"},{id:"7",sender:"character",content:"我在一家咨询公司工作，负责数据分析和报告撰写。工作比较繁忙，但我喜欢这种需要专注和逻辑思维的任务。同事们都说我工作很认真，有时候甚至过于严肃了...",timestamp:"19:37"}],m={参考卡:"bg-blue-500/20 text-blue-500 dark:bg-blue-500/30 dark:text-blue-300",分组一:"bg-purple-500/20 text-purple-500 dark:bg-purple-500/30 dark:text-purple-300",老婆:"bg-red-500/20 text-red-500 dark:bg-red-500/30 dark:text-red-300",人妻:"bg-orange-500/20 text-orange-500 dark:bg-orange-500/30 dark:text-orange-300",变装:"bg-green-500/20 text-green-500 dark:bg-green-500/30 dark:text-green-300",口交特化:"bg-pink-500/20 text-pink-500 dark:bg-pink-500/30 dark:text-pink-300",性冷淡:"bg-indigo-500/20 text-indigo-500 dark:bg-indigo-500/30 dark:text-indigo-300",小穴特化:"bg-rose-500/20 text-rose-500 dark:bg-rose-500/30 dark:text-rose-300"};function h(){(0,l.useParams)();let e=(0,l.useRouter)(),r=(0,l.useSearchParams)(),t=r.get("characterId"),c=r.get("shareStoryId"),[d,h]=(0,a.useState)(null),[g,u]=(0,a.useState)(null),[b,p]=(0,a.useState)(!0),[v,f]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1),[y,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=window.fetch,r={name:"测试用户",email:"test@example.com",id:"user-123"};return f(r),localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("user.token","mock-jwt-token-for-testing"),window.fetch=function(r,t){let s="string"==typeof r?r:r instanceof URL?r.toString():r instanceof Request?r.url:"";return s.includes("/api/v1/users/me")||s.includes("/api/v1/chat/stories")||s.includes("/api/auth/")?(console.log("拦截API请求:",s),Promise.resolve(new Response(JSON.stringify({data:{id:"mock-id",name:"测试用户",email:"test@example.com"},items:[]}),{status:200,headers:{"Content-Type":"application/json"}}))):e.apply(this,[r,t])},()=>{window.fetch&&window.fetch.toString().includes("拦截API请求")&&(window.fetch=e)}},[]),(0,a.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{f(JSON.parse(e))}catch(e){console.error("Failed to parse user from localStorage")}},[]),(0,a.useEffect)(()=>{t&&c&&(h({id:t,name:"裴清商",avatarUrl:"/backgrounds/default-avatar.jpg",tags:["性冷淡","参考卡","人妻"],description:"一个性格冷淡的数据分析师",shouldBlurAvatar:!1,categories:[],popularity:0,chats:0}),u({title:"狼狼的带入了",author:"某月",timeAgo:"大约12小时前"}),p(!1))},[t,c]);let w=()=>{if(!v)return void document.dispatchEvent(new CustomEvent("open-login-modal",{detail:{tab:"login"}}));try{if(k(!0),!t)return void o.oR.error("无法找到角色信息");e.push("/chat?id=".concat(t))}catch(e){console.error("导航错误:",e),o.oR.error("跳转失败，请重试"),k(!1)}},S=()=>{if(!v)return void document.dispatchEvent(new CustomEvent("open-login-modal",{detail:{tab:"login"}}));try{if(k(!0),!t)return void o.oR.error("无法找到角色信息");let r=JSON.stringify(x);localStorage.setItem("chat_history_".concat(t),r),e.push("/chat?id=".concat(t))}catch(e){console.error("导航错误:",e),o.oR.error("跳转失败，请重试"),k(!1)}};return b?(0,s.jsx)("div",{className:"pt-24 pb-16 px-4 text-center",children:(0,s.jsx)("p",{className:"text-foreground",children:"加载中..."})}):d&&g?(0,s.jsxs)("div",{className:"pt-24 pb-16 px-4",children:[(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"bg-card rounded-lg shadow-md p-6 mb-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:g.title}),(0,s.jsxs)("div",{className:"flex items-center mt-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:g.timeAgo}),(0,s.jsx)("span",{className:"mx-2 text-muted-foreground/60",children:"•"}),(0,s.jsxs)("span",{className:"text-muted-foreground text-sm",children:["由 ",g.author," 分享"]})]})]}),(0,s.jsx)(i.$,{className:"bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:()=>N(!0),disabled:y,children:"开始对话"})]}),(0,s.jsxs)("div",{className:"flex items-center p-4 bg-muted rounded-lg mb-6",children:[(0,s.jsx)("div",{className:"relative h-16 w-16 rounded-full overflow-hidden mr-4",children:(0,s.jsx)(n.default,{src:d.avatarUrl,alt:d.name,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-foreground",children:d.name}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:d.tags.slice(0,3).map((e,r)=>(0,s.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat(m[e]||"bg-primary/20 text-primary dark:text-primary-foreground"),children:e},r))})]})]})]}),(0,s.jsx)("div",{className:"mb-8",children:x.map(e=>(0,s.jsxs)("div",{className:"mb-4 ".concat("user"===e.sender?"ml-12":"mr-12"),children:[(0,s.jsx)("div",{className:"rounded-lg p-4 ".concat("user"===e.sender?"bg-primary/20 text-foreground":"bg-card text-foreground"),children:e.content}),(0,s.jsx)("div",{className:"text-xs mt-1 ".concat("user"===e.sender?"text-right text-muted-foreground":"text-left text-muted-foreground"),children:e.timestamp})]},e.id))}),(0,s.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,s.jsx)(i.$,{className:"bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:w,disabled:y,children:"全新对话"}),(0,s.jsx)(i.$,{className:"w-full bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:S,disabled:y,children:y?"跳转中...":"基于此继续"})]})]}),j&&(0,s.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-card rounded-lg shadow-xl p-6 max-w-md w-full",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-foreground mb-4",children:"选择对话方式"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"你可以选择开始一个全新的对话，或者基于当前对话继续聊天。"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(i.$,{className:"w-full bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:w,disabled:y,children:y?"跳转中...":"全新对话"}),(0,s.jsx)(i.$,{className:"w-full bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:S,disabled:y,children:y?"跳转中...":"基于此继续"}),(0,s.jsx)(i.$,{className:"w-full bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:()=>N(!1),disabled:y,children:"取消"})]})]})})]}):(0,s.jsxs)("div",{className:"pt-24 pb-16 px-4 text-foreground text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"对话不存在"}),(0,s.jsx)("p",{className:"mb-8",children:"无法找到该对话，请返回角色库选择其他角色。"}),(0,s.jsx)(i.$,{className:"bg-[var(--bg-secondary)] border-[var(--border-color)] hover:bg-[var(--bg-tertiary)]",onClick:()=>e.push("/characters"),children:"返回角色库"})]})}function g(){return(0,s.jsxs)("main",{className:"min-h-screen bg-background",children:[(0,s.jsx)(c.default,{}),(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(u,{}),children:(0,s.jsx)(h,{})}),(0,s.jsx)(d.default,{})]})}function u(){return(0,s.jsxs)("div",{className:"pt-24 pb-16 px-4 text-center",children:[(0,s.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent text-primary motion-reduce:animate-[spin_1.5s_linear_infinite]",children:(0,s.jsx)("span",{className:"sr-only",children:"Loading..."})}),(0,s.jsx)("p",{className:"mt-2 text-foreground",children:"正在加载对话内容..."})]})}},4515:(e,r,t)=>{Promise.resolve().then(t.bind(t,3141))},6821:(e,r,t)=>{"use strict";t.d(r,{default:()=>d});var s=t(5155),a=t(6874),l=t.n(a),c=t(6766);function d(){return(0,s.jsx)("footer",{className:"bg-[var(--bg-primary)] text-[var(--text-primary)] py-16 px-4",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,s.jsxs)("div",{className:"col-span-1 md:col-span-1",children:[(0,s.jsx)(l(),{href:"/",className:"inline-block mb-4",children:(0,s.jsx)(c.default,{src:"https://ext.same-assets.com/715601384/683049629.png",alt:"QuackAI",width:120,height:30,className:"mb-4"})}),(0,s.jsx)("p",{className:"text-sm text-[var(--text-secondary)] mb-4",children:"基于酒馆(SillyTavern)的AI角色扮演平台，提供免搭建酒馆，同时提供轻享版角色互动"}),(0,s.jsx)("div",{className:"flex space-x-4",children:(0,s.jsx)(l(),{href:"https://discord.gg/RBDVwJdFh3",target:"_blank",rel:"noopener noreferrer",className:"text-[var(--text-primary)] hover:text-[var(--text-secondary)]",children:(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"})})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-lg mb-4",children:"产品"}),(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"酒馆 | STUDIO"})}),(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"聊天 | CHAT"})}),(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"酒馆 | SILLYTAVERN"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-lg mb-4",children:"资源"}),(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"API KEY"})}),(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"使用说明"})}),(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"教程计划"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-lg mb-4",children:"关于"}),(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"https://discord.gg/RBDVwJdFh3",target:"_blank",rel:"noopener noreferrer",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"加入社区"})}),(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"在线地址"})}),(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:"#",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:"福利领取"})})]})]})]}),(0,s.jsx)("div",{className:"border-t border-[var(--border-color)] mt-12 pt-8 text-center text-sm text-[var(--text-secondary)]",children:(0,s.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," QuackAI. All rights reserved."]})})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[951,320,428,702,500,698,613,917,441,684,358],()=>r(4515)),_N_E=e.O()}]);